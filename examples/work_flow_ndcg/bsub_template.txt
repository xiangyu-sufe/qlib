#BSUB -J grundcg_lr__LR___sigma__SIGMA__
#BSUB -q gpu
#BSUB -m "gpu01 gpu02 gpu03 gpu04 gpu05 gpu06"
#BSUB -gpu "num=1"
#BSUB -n 1
#BSUB -o logs/grundcg_lr__LR___sigma__SIGMA___%J.out
#BSUB -e logs/grundcg_lr__LR___sigma__SIGMA___%J.err

mkdir -p logs

# 记录开始时间和参数
echo "=== 任务开始 ===" >> logs/grundcg_lr__LR___sigma__SIGMA___%J.out
echo "时间: $(date '+%Y-%m-%d %H:%M:%S')" >> logs/grundcg_lr__LR___sigma__SIGMA___%J.out
echo "学习率: __LR__" >> logs/grundcg_lr__LR___sigma__SIGMA___%J.out
echo "Sigma: __SIGMA__" >> logs/grundcg_lr__LR___sigma__SIGMA___%J.out
echo "作业ID: %J" >> logs/grundcg_lr__LR___sigma__SIGMA___%J.out
echo "=================" >> logs/grundcg_lr__LR___sigma__SIGMA___%J.out

# 显示当前工作目录和环境
echo "当前工作目录: $(pwd)" >> logs/grundcg_lr__LR___sigma__SIGMA___%J.out
echo "Python路径: $(which python)" >> logs/grundcg_lr__LR___sigma__SIGMA___%J.out

# 运行Python脚本，同时输出到控制台和文件
python workflow_ndcg.py --lr __LR__ --sigma __SIGMA__ --save_path __LR___sigma__SIGMA__ 2>&1 | tee -a logs/grundcg_lr__LR___sigma__SIGMA___%J.out

# 记录结束时间
echo "=== 任务结束 ===" >> logs/grundcg_lr__LR___sigma__SIGMA___%J.out
echo "时间: $(date '+%Y-%m-%d %H:%M:%S')" >> logs/grundcg_lr__LR___sigma__SIGMA___%J.out
